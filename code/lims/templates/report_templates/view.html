{% extends "view_template.html" %}

{% block buttons %}
{% if current_user.permissions in ['Admin', 'Owner'] %}
  <!-- Inactivate trigger -->
   {% if item.status.name == 'Active' %}
  <button type="button"
          class="btn btn-danger"
          data-toggle="modal"
          data-target="#setInactiveModal">
    Set to inactive
  </button>
  {% endif %}

  <!-- Activate trigger (only if currently Inactive) -->
  {% if item.status.name == 'Inactive' %}
    <button type="button"
            class="btn btn-success"
            data-toggle="modal"
            data-target="#setActiveModal">
      Set to active
    </button>
  {% endif %}
{% endif %}
{% endblock %}

{% block view %}
<h2>Status = {{ item.status.name }}</h2>

<!-- Inactivate Modal -->
<div class="modal fade" id="setInactiveModal" tabindex="-1" role="dialog" aria-labelledby="setInactiveModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="setInactiveModalLabel">Confirm Inactivation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        Are you sure you want to set this report template to Inactive?
      </div>

      <div class="modal-footer">
        <a class="btn btn-primary" href="{{ url_for('report_templates.set_inactive', item_id=item.id) }}">
          Continue
        </a>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
      </div>

    </div>
  </div>
</div>

<!-- Activate Modal -->
<div class="modal fade" id="setActiveModal" tabindex="-1" role="dialog" aria-labelledby="setActiveModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="setActiveModalLabel">Confirm Activation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        Are you sure you want to set this report template to Active?
      </div>

      <div class="modal-footer">
        <a class="btn btn-primary" href="{{ url_for('report_templates.set_active', item_id=item.id) }}">
          Continue
        </a>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
      </div>

    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Append modals to <body> to avoid stacking context issues
  $(function () {
    var $inactive = $('#setInactiveModal');
    var $active = $('#setActiveModal');
    if ($inactive.length) { $inactive.appendTo('body'); }
    if ($active.length) { $active.appendTo('body'); }
  });
</script>
{% endblock %}
