{% extends "base.html" %}
{% block content %}

<div id="header">
    {% if item.locked %}
    <div class="alert alert-warning" role="alert" style="margin-top: 12px">
        <i class="fa-solid fa-lock"></i> <b>{{alias}}</b> has been locked by <b>{{item.locked_by}}</b> on
        <b>{{item.lock_date.strftime('%m/%d/%Y')}}</b>
        at <b>{{item.lock_date.strftime('%H:%M')}}</b>.
    </div>
    {% elif item.db_status == 'Removal Pending' %}
    <div class="alert alert-warning" role="alert" style="margin-top: 12px">
        <b>{{alias}}</b> has been marked for removal by <b>{{item.modified_by}}</b>
        on <b>{{item.modify_date.strftime('%m/%d/%Y')}}</b> at <b>{{item.modify_date.strftime('%H:%M')}}</b>.
        for the following reason:
        <ul>
            <li>{{item.remove_reason}}</li>
        </ul>
    </div>
    {% elif item.db_status == 'Removed' %}
    <div class="alert alert-warning" role="alert" style="margin-top: 12px">
        <b>{{alias}}</b> was removed by <b>{{item.modified_by}}</b> on
        <b>{{item.modify_date.strftime('%m/%d/%Y')}}</b> at <b>{{item.modify_date.strftime('%H:%M')}}</b>.
    </div>
    {% endif %}

    {% if pending_mods %}
    <div class="alert alert-warning" role="alert" style="margin-top: 12px">
        <b>{{alias}}</b> has pending changes for the following fields by
        <b>{{pending_mods[0].submitter.initials}}</b> at <b>{{pending_mods[0].submitted_date.strftime("%m/%d/%Y
            %H:%M")}}</b>:
        <ul>
            {% for mod in pending_mods %}
            <li>
                <b>{{mod.field}}</b>: {{mod.original_value_text}} > {{mod.new_value_text}}
            </li>
            {% endfor %}
        </ul>
    </div>

    {% endif %}


    <!-- ALERT BLOCK -->

    {% block alerts %}
    {% endblock %}

    <!-- ########## -->

<style>
    .alert-warning {
        background-color: rgb(221, 204, 238);
        color: black;
        border-color: #8b53e6
    }
</style>
<div style="margin-top:6px">
        <a href="{{url_for('dashboard.get_dashboard')}}"><i class="fa-solid fa-house"></i></a>
        > <a href="{{url_for(table_name~'.view_list')}}">Packets</a>

        > {{kwargs['packet_name']}}
    </div>

    <hr style="border-width:5px; margin-top: 6px">
    <h1>
        <a href="{{url_for('cases.view', item_id=item.case_id)}}">{{kwargs['packet_name']}}</a> | {{ item.packet_status
        }}
    </h1>

    <hr style="border-width:5px">

    <div id="body" class="mt-3">
        {% if item.communications %}
        <div class="alert alert-warning" role="alert" style="margin-top:6px">
            {{ item.communications | replace('\n', '<br>') | safe }}
        </div>

        {% endif %}
        <!-- VIEW BLOCK -->
        {% if current_user.permissions in ['Admin', 'Owner', 'FLD', 'FLD-Administrative'] %}
        <div>
            {% if item.packet_status != 'Canceled' %}
            <a class="btn btn-primary" href="{{ url_for(table_name~'.update', item_id=item.id) }}">
                <i class="fa fa-pencil"></i> Add Details
            </a>
            <!--            <a class="btn btn-primary" href="/cases/{{item.case_id}}/litigation_packet_form?packet_name={{kwargs['packet_name']}}">-->
            <a class="btn btn-primary" href="/cases/{{item.case_id}}/litigation_packet_form?packet_id={{item.id}}">
                Generate
            </a>
            {% if item.packet_status == 'Ready for PP' %}
            <a class="btn btn-primary" href="{{ url_for(table_name~'.ready_for_declaration', item_id=item.id) }}">
                Ready for Declaration
            </a>
            {% endif %}
            {% if item.packet_status in ['Waiting for Declaration'] %}
            <a class="btn btn-primary" href="/litigation_packets/{{item.id}}/completed_packet">
                Ready for PR (Upload)
            </a>
            {% endif %}

            {% if item.packet_status == 'Created' %}
            <a class="btn btn-primary d-none" href="{{ url_for(table_name~'.ready_for_lp', item_id=item.id) }}">
                Ready for PP
            </a>
            {% endif %}
            <!--                <a class="btn btn-primary" href="{{url_for(table_name~'.lp', item_id=item.id)}}" >-->
            <!--                    LP-->
            <!--                </a>-->
            {% if kwargs['zip_files'] %}
            {% for zip_file in kwargs['zip_files'] %}
            {% if item.packet_status == 'Ready for PR' and item.prep_user.initials != current_user.initials %}
            <a class="btn btn-primary"
                href="{{ url_for(table_name ~ '.lr', item_id=item.id, packet_name=kwargs.packet_name, file_name=zip_file, record = kwargs['record']) }}">
                PR
            </a>
            {% endif %}
            {% endfor %}
            {% else %}
            {% if item.packet_status == 'Ready for PR' and item.prep_user.initials != current_user.initials %}
            <a class="btn btn-primary"
                href="{{ url_for(table_name ~ '.lr', item_id=item.id, packet_name=kwargs.packet_name, file_name=zip_file, record=kwargs['record'] )}}">
                PR
            </a>
            {% endif %}
            {% endif %}
            {% if item.packet_status == 'Ready for PR' %}
            <a class="btn btn-primary" href="/litigation_packets/{{item.id}}/revised_packet">
                Upload Revision
            </a>
            <a class="btn btn-primary" href="#" onclick="$('#revertModal').modal({backdrop:'static', keyboard:false});">
                Revert
            </a>
            
            {% endif %}
            {% if item.packet_status != 'Finalized' %}
            <a class="btn btn-primary" href="{{url_for(table_name~'.communications', item_id=item.id)}}">
                Add Communication
            </a>
            {% endif %}
            <a class="btn btn-secondary" href="{{ url_for(table_name~'.attach', item_id=item.id) }}">
                <i class="fa-solid fa-paperclip"></i> Attach
            </a>
            {% if item.locked_by == current_user.initials or current_user.permissions in ['Admin', 'Owner'] %}
            <a class="btn btn-secondary" href="{{url_for(table_name~'.unlock', item_id=item.id)}}"><i
                    class="fa-solid fa-unlock"></i> Unlock</a>
            {% endif %}
            <!--            <a class="btn btn-secondary" href="{{url_for(table_name~'.cancel', item_id=item.id)}}">-->
            <!--                Cancel-->
            <!--            </a>-->
            <a class="btn btn-secondary" href="#"
                onclick="showConfirmModal('{{ url_for(table_name + '.cancel', item_id=item.id) }}')">
                Cancel
            </a>
            {% endif %}

        </div>
        <div style="margin-top: 1%;">
            {% if item.case.create_date and item.case.create_date >= datetime(2025, 1, 1) and item.case.create_date <=
                datetime(2025, 3, 31) %} <p style="font-size: 13pt;">For Packet Preparation: This case requires manual
                removal of LCQD, LCFS and LCCI batch report pages.</p>
                {% endif %}
        </div>

        {% endif %} <!-- ENDIF FOR CURRENT_USERS.PERMISSIONS -->
        {% block view %}
        {% endblock %}
        <div id="all-content" style="padding-top:1%;">
            <div id="cases-pdf">
                <div id="header-two">
                    <div id="body-two">
                        <div id="case_accordion">
                            <div class="card">
                                <div class="card-header" id="details_heading"
                                    style="height:50px; padding:0px; display:flex;align-items:center;">
                                    <button aria-controls="details" aria-expanded="false"
                                        class="btn btn-link chevron-btn" data-target="#details" id="case_details_btn">
                                        Packet Details
                                    </button>
                                </div>
                                <div aria-labelledby="details_heading" class="collapse show" id="details">
                                    <div class="card-body">
                                        <div class="row">
                                            <!-- First Table -->
                                            <div class="col-md-4">
                                                <table class="table table-hover table-striped details-table">
                                                    <tbody>
                                                        {% if item.declaration_sent %}
                                                        <tr>
                                                            <th>Declaration Request</th>
                                                            <td>Sent by {{item.declaration_sent.initials}}
                                                                {{item.declaration_sent_datetime.strftime('%m/%d/%Y
                                                                %H:%m')}}</td>
                                                        </tr>
                                                        {% else %}
                                                        <tr>
                                                            <th>Declaration Request</th>
                                                            <td><a
                                                                    href="{{url_for(table_name~'.declaration_sent', item_id=item.id)}}">Request
                                                                    Sent</a></td>
                                                        </tr>
                                                        {% endif %}
                                                        <tr>
                                                            <th>Requested Agency</th>
                                                            <td>{{ item.agency.name }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Requested Division</th>
                                                            <td>{{ item.division.name }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Requested Personnel</th>
                                                            <td>{{ item.personnel.full_name }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Requested Date</th>
                                                            <td>{{ item.requested_date.strftime('%m/%d/%Y') if
                                                                item.requested_date else '' }}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>Due Date</th>
                                                            <td>{{ item.due_date.strftime('%m/%d/%Y') if item.due_date
                                                                else
                                                                '' }}
                                                            </td>
                                                        </tr>

                                                    </tbody>
                                                </table>
                                            </div>

                                            <!-- Second Table -->
                                            <div class="col-md-4">
                                                <table class="table table-hover table-striped details-table">
                                                    <tbody>
                                                        <tr>
                                                            <th>Delivery Date</th>
                                                            <td>{{ item.delivery_date.strftime('%m/%d/%Y') if
                                                                item.delivery_date
                                                                else '' }}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>Delivered Agency</th>
                                                            <td>{{ item.del_agency.name }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Delivered Division</th>
                                                            <td>{{ item.del_division.name }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Delivered Personnel</th>
                                                            <td>{{ item.del_personnel.full_name }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Number of Pages</th>
                                                            <td>{{ item.n_pages }}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Postage and Delivery</th>
                                                            <td>{% if item.postage_and_delivery %}${{
                                                                item.postage_and_delivery }}{%endif%}</td>
                                                        </tr>

                                                    </tbody>
                                                </table>
                                            </div>

                                            <!-- Third Table -->
                                            <div class="col-md-4">
                                                <table class="table table-hover table-striped details-table">
                                                    <tbody>
                                                        <tr>
                                                            <th>Additional Costs</th>
                                                            <td>{% if item.additional_costs %}${{ item.additional_costs
                                                                }}{%endif%}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Total Costs</th>
                                                            <td>{% if item.total_costs %}${{ item.total_costs }}{% endif
                                                                %}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Paid Date</th>
                                                            <td>{{ item.paid_date.strftime('%m/%d/%Y') if item.paid_date
                                                                else '' }}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>Created By</th>
                                                            <td>{{ item.created_by }} {% if item.create_date %}
                                                                {{item.create_date.strftime('%m/%d/%Y %H:%M')}}
                                                                {% endif %}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>PP</th>
                                                            <td>{% if item.litigation_preparer %}
                                                                {{ item.prep_user.initials }} {{
                                                                item.litigation_prepare_date.strftime('%m/%d/%Y %H:%M')
                                                                if
                                                                item.litigation_prepare_date else 'N/A' }}
                                                                {% endif %}
                                                        </tr>
                                                        <tr>
                                                            <th>PR</th>
                                                            <td>{% if item.litigation_reviewer %}
                                                                {{ item.rev_user.initials }} {{
                                                                item.litigation_review_date.strftime('%m/%d/%Y %H:%M')
                                                                if
                                                                item.litigation_review_date else 'N/A' }}
                                                                {% endif %}
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <!-- Add any additional content or buttons below -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- ######### -->


        <div id="accordion">
            {% block accordion %}
            {% endblock %}
            <div class="card">
                <div class="card-header" id="attachments"
                    style="height:50px; padding:0px; display:flex;align-items:center;">
                    <button class="btn btn-link chevron-btn" data-toggle="collapse" data-target="#attachments-collapse"
                        aria-expanded="false" aria-controls="attachments">
                        <span><i class="fa-solid fa-chevron-right mr-2 chevron" style="border: '#FF0000'"></i></span>
                        Attachments
                    </button>
                </div>
                <div id="attachments-collapse" class="collapse" aria-labelledby="attachments-heading">
                    <div class="card-body">
                        <div class="table display">
                            <div class="table-responsive">
                                <table class="display table-striped table-hover nowrap small datatable"
                                    style="width:100%;" id="attachments-table">
                                    <thead>
                                        <tr>
                                            <th>Delete</th>
                                            <th>File Name</th>
                                            <th>Save Name</th>
                                            <th>Type</th>
                                            <th>Source</th>
                                            <th>Description</th>
                                            <th>Added By</th>
                                            <th>Add Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for attachment in attachments%}
                                        <tr>
                                            <td><a href="{{url_for('attachments.delete', item_id=attachment.id)}}"
                                                    class="btn btn-danger btn-size"><i class="fa fa-trash-o btn-icon"
                                                        style="font-size:10px"></i></a></td>
                                            <td>
                                                {% if attachment.name.split('.')[1] in ['pdf', 'jpg', 'png'] %}
                                                <a href="../static/filesystem/attachments/{{item_name}}/{{item.id}}/{{attachment.save_name}}"
                                                    target="_blank">{{attachment.name}}</a>
                                                {% else %}
                                                <a href="../static/filesystem/attachments/{{item_name}}/{{item.id}}/{{attachment.save_name}}"
                                                    download>{{attachment.name}}</a>
                                                {% endif %}
                                            </td>
                                            <td>{{attachment.save_name}}</td>
                                            <td>{{attachment.type.name}}</td>
                                            <td>{{attachment.type.source}}</td>
                                            <td>{{attachment.description}}</td>
                                            <td>{{attachment.created_by}}</td>
                                            <td>
                                                {% if attachment.create_date %}
                                                {{attachment.create_date.strftime('%m/%d/%Y %H:%M')}}
                                                {% endif %}
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card" style="display: none;">
                <div class="card-header" id="modifications"
                    style="height:50px; padding:0px; display:flex;align-items:center;">
                    <button class="btn btn-link chevron-btn" data-toggle="collapse"
                        data-target="#modifications-collapse" aria-expanded="false" aria-controls="modifications">
                        <span><i class="fa-solid fa-chevron-right mr-2 chevron" style="border: '#FF0000'"></i></span>
                        Modifications
                    </button>
                </div>
                <div id="modifications-collapse" class="collapse" aria-labelledby="modifications-heading">
                    <div class="card-body">
                        <div class="table display" id="table-div">
                            <div class="table-responsive">
                                <table class="display table-striped table-hover nowrap small datatable"
                                    style="width:100%;" id="modifications-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Event</th>
                                            <th>Status</th>
                                            <th>Revision</th>
                                            <th>Field</th>
                                            <th>Original Value</th>
                                            <th>New Value</th>
                                            <th>Submitted By</th>
                                            <th>Submitted Date</th>
                                            <th>Reviewed By</th>
                                            <th>Reviewed Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for item in mods %}
                                        <tr>
                                            <td>{{item.id}}</td>
                                            <td>{{item.event}}</td>
                                            <td>{{item.status}}</td>
                                            <td>{{item.revision}}</td>
                                            <td>{{item.field}}</td>
                                            <td>{{item.original_value_text}}</td>
                                            <td>
                                                {% if item.field_name == 'file_name' %}
                                                <a href="../static/filesystem/imports/{{item.new_value_text}}" download>
                                                    {{item.new_value_text}}
                                                </a>
                                                {% else %}
                                                {{item.new_value_text}}
                                                {% endif %}
                                            </td>
                                            <td>{{item.submitter.initials}}</td>
                                            <td>{{item.submitted_date.strftime("%m/%d/%Y %H:%M")}}</td>
                                            <td>
                                                {% if item.reviewed_by %}
                                                {{item.reviewer.initials}}
                                                {% endif %}
                                            </td>
                                            <td>
                                                {% if item.review_date %}
                                                {{item.review_date.strftime("%m/%d/%Y %H:%M")}}
                                                {% endif %}
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="accordion-two">
            <div class="card">
                <div class="card-header" id="uploaded-files"
                    style="height:50px; padding:0px; display:flex;align-items:center;">
                    <button aria-controls="uploaded-files" aria-expanded="false" class="btn btn-link chevron-btn"
                        data-target="#uploaded-files-collapse" data-toggle="collapse">
                        <span><i class="fa-solid fa-chevron-right mr-2 chevron"></i></span>
                        Completed Packets
                    </button>
                </div>
                <div aria-labelledby="uploaded-files-heading" class="collapse" id="uploaded-files-collapse">
                    <div class="card-body">
                        {% if kwargs['uploaded_files'] %}
                        <div class="table display" id="table-div">
                            <div class="table-responsive">
                                <table class="display table-striped table-hover nowrap small datatable"
                                    style="width:100%;" id="modifications-table">
                                    <thead>
                                        <tr>
                                            <th>Filename</th>
                                            <th>Completed At</th>
                                            <th>Size (MB)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for file in kwargs['uploaded_files'] %}
                                        <tr>
                                            <td>
                                                <a href="#" onclick="showPDF('{{ loop.index0 }}')">
                                                    {{ file.filename }}
                                                </a>
                                                <!-- Hidden PDF container -->
                                                <div class="pdf-container" id="pdf-container-{{ loop.index0 }}"
                                                    style="display: none; margin-top: 10px;">
                                                    <embed
                                                        src="{{ url_for('static', filename='packet upload/' ~ kwargs['folder_name'] ~ '_Uploads/' ~ file.filename) }}"
                                                        type="application/pdf" width="100%" height="600px"
                                                        style="border: 1px solid #ddd;">
                                                    </embed>
                                                </div>
                                            </td>
                                            <td>{{ file.modified_time.strftime("%m/%d/%Y %H:%M") }}</td>
                                            <td>{{ (file.file_size / (1024*1024))|round(1) }}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        {% else %}
                        <p>No files uploaded yet.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>



    </div>
</div>


<!-- MODALS -->
{% if kwargs.zip_files and kwargs.zip_files|length > 0 %}
<div class="modal fade" id="fileModal" tabindex="-1" role="dialog" aria-labelledby="fileModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="fileModalLabel">Download Available</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>The following litigation packet(s) are ready for download:</p>
                <ul style="list-style:none; padding-left: 0px;">
                    {% for zip_file in kwargs['zip_files'] %}
                    <li>
                        <a href="{{ url_for('download_packet', packet_name=kwargs.packet_name, file_name=zip_file) }}"
                            class="btn btn-primary">
                            {{ zip_file }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $('#fileModal').modal('show');
    });
</script>
{% endif %}


<!-- REMOVE ITEM -->
<div class="modal" tabindex="-1" role="dialog" id="remove-modal">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Remove {{alias}}?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form action="{{ url_for(table_name~'.remove', item_id=item.id) }}" method="POST">
                <div class="modal-body">
                    <p>Are you sure you want to remove <b>{{alias}}</b>?</p>
                    <label>Please enter the reason for removal.</label>
                    <div class="form-group">
                        <textarea class="form-control" name="reason" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <input class="btn btn-danger" type="submit" value="Remove">
                </div>
            </form>
        </div>
    </div>
</div>

<!-- DELETE ITEM  -->
<div class="modal" tabindex="-1" role="dialog" id="delete-modal">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete {{alias}}?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete <b>{{alias}}</b>?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>

                <form action="{{ url_for(table_name~'.delete', item_id= item.id) }}" method="POST">
                    <input class="btn btn-danger" type="submit" value="Delete">
                </form>
            </div>
        </div>
    </div>
</div>
<!-- MODAL FOR CANCEL STATUS -->
<div class="modal fade" id="confirmCancelModal" tabindex="-1" role="dialog" aria-labelledby="confirmCancelLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmCancelLabel">Confirm Cancellation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to cancel this item?
            </div>
            <div class="modal-footer d-flex justify-content-start">
                <button type="button" class="btn btn-danger" id="confirmCancelBtn">Yes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
            </div>
        </div>
    </div>
</div>
<!-- MODAL BLOCK -->

{% block modals %}
<!-- REVERT MODAL -->
<div class="modal fade" id="revertModal" tabindex="-1" role="dialog" aria-labelledby="revertModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form action="{{ url_for(table_name ~ '.revert', item_id=item.id) }}" method="POST" class="modal-content">
            {% if csrf_token is defined %}{{ csrf_token() }}{% endif %}
            <div class="modal-header">
                <h5 class="modal-title" id="revertModalLabel">Confirm Revert</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to revert? This will remove initials from PP.
            </div>
            <div class="modal-footer d-flex justify-content-start">
                <button type="submit" class="btn btn-primary">Continue</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Exit</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

<!-- ########## -->

<!-- SCRIPT BLOCK -->

{% block scripts %}
{% endblock %}

<!-- ########## -->

<script>
    function showPDF(index) {
        var container = document.getElementById('pdf-container-' + index);
        if (container.style.display === "none") {
            container.style.display = "block";
        } else {
            container.style.display = "none";
        }
    }
    function showConfirmModal(cancelUrl) {
        // Show the confirmation modal
        $('#confirmCancelModal').modal('show');

        // Set the click handler for the confirm button
        document.getElementById('confirmCancelBtn').onclick = function () {
            window.location.href = cancelUrl; // Redirect to the cancel route if confirmed
        };
    }
</script>
<script src="/static/main.js"></script>


<!--<script>-->
<!--$(document).ready(function () {-->
<!--    $.each($('.datatable'), function () {-->
<!--        console.log($(this).attr('id'));-->
<!--        initDataTable($(this), [], 100);-->
<!--    });-->
<!--})-->
<!--</script>-->

<script>
    $(document).ready(function () {
        var mod = initDataTable($('#modifications-table'), 100);
        var att = initDataTable($('#attachments-table'), 100);
    });
</script>


<script type="text/javascript">
    $(document).ready(function () {
        $('.expand').on('click', function () {
            var isExpanded = $(this).parents().next('.row_control').attr("aria-expanded")
            $(this).parents().next('.hidden_row').toggle();
            //alert();

        });
    });
</script>

<script>
    $('.collapse').on('shown.bs.collapse', function () {
        $($.fn.dataTable.tables(true)).DataTable()
            .columns.adjust();
    });
</script>

<script>
    $('.chevron-btn').on('click', function () {
        var isExpanded = $(this).attr("aria-expanded");

        if ($(this).find('.chevron').hasClass("fa-chevron-right")) {
            if (isExpanded == 'false') {
                $(this).find('.chevron').addClass("fa-chevron-down");
                $(this).find('.chevron').removeClass("fa-chevron-right");
            }
        } else {
            if (isExpanded == 'true') {
                $(this).find('.chevron').addClass("fa-chevron-right");
                $(this).find('.chevron').removeClass("fa-chevron-down");
            }
        }
    });
</script>


{% endblock %}