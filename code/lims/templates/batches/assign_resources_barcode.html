{% extends "base.html" %}
{% block content %}

<style>
.button {
 padding: 10px 24px
}
</style>

<div class = "container">
    <h1>Scan Constituents</h1>
    <form class="needs-validation" method="POST" novalidate="novalidate" enctype="multipart/form-data">
        {{form.hidden_tag()}}

        <div class="form-group">
            {{form.constituent.label(class='form-group')}}
            {{form.constituent(class='form-control'~status)}}
        </div>
        <div class = "form-group">
            {{form.submit(class='btn btn-primary')}}
           <button type="button" class="btn btn-secondary" onclick="history.back()">Back</button>
        </div>
    </form>
</div>

<script>
    $(document).ready(function () {
        var table = $('#constituents').DataTable({
            dom: 'lt<i>rp',
            scrollX: true,
            "language": {
            "emptyTable": "Please select an assay to see available tests"
             },
            'pageLength': 100,
        });
    });
</script>

<script type=text/javascript>
    var dataOrder = [];
    var orderArr = []
    $("#constituents").on('click', 'tbody tr', function (e) {
        var table = $('#constituents').DataTable();
        var x = dataOrder.length +1
        var dataArr = [];
        $(this).toggleClass('table-active');
        $.each($("#constituents tr.table-active"),function(){ //get each tr which has selected class
            dataArr.push($(this).find('td').eq(2).text()); //find its first td and push the value
        });

        $('#constituent_id').val(dataArr);

        var rowIndex = $(this).find('td').eq(0).text();
        id = $(this).find('td').eq(1).text()
        order = Number($(this).find('td').eq(2).text())
        });

</script>

<script type=text/javascript>
     $(function() {
        $('.clear').on('click', function() {
             $.each($("#constituents tbody tr"),function(){
                 $(this).removeClass('table-active');
             });
            var name = event.target.name;
            var select = document.getElementById(name);
            $(select).val("")
         });
    });
</script>

<script>
    $('#select_all').click(function() {
         $.each($("#constituents tbody tr"),function(){
             $(this).addClass('table-active');
         });

         var selected = [];
         var x = 1
         $.each($("#constituents tr.table-active"),function(){
            selected.push($(this).find('td').eq(0).text());
         });

        $('#constituent_selection').val(selected);
    });
</script>

{% endblock %}
